---
layout: post
title: Animating tSNE iterations
subheading: A stepwise implementation of tSNE
author: Johannes
categories: Data-Science
banner: assets/images/banners/rnaseqinr_banner.png
---
``` r
library(HDCytoData)
library(rsvd)
library(reticulate)
library(tidyverse)
library(ggpubr)

source('~/development/FIt-SNE-master/fast_tsne.R', chdir=T)
reticulate::use_python('/usr/local/bin/python3.9', required = T)

fs <- HDCytoData::Levine_13dim_SE()
colnames(fs)
```

    ##  [1] "CD45"   "CD45RA" "CD19"   "CD11b"  "CD4"    "CD8"    "CD34"   "CD20"  
    ##  [9] "CD33"   "CD123"  "CD38"   "CD90"   "CD3"

``` r
vars <- colnames(fs)

ds <- fs %>%
  SummarizedExperiment::assay() %>% # extract the data
  as.data.frame() %>% # convert to data frame
  select(vars) %>% # select markers of interest
  mutate_all(function(x, cofactor = 5) asinh(x / cofactor)) %>% # transform data with arcsinh (cofactor of 5)
  mutate_all(function(x)(x - min(x)) / (max(x) - min(x))) %>% # min max normalisation
  mutate(population_id = rowData(fs)$population_id) %>% # add population id column
  filter(population_id != 'unassigned') %>%
  #filter(population_id %in% unique(population_id[grep('T_cells', population_id)])) %>% # filter T cell populations
  #mutate(population_id = sub('.*(B_cells)', '\\1', population_id)) %>% 
  sample_n(10000)

ggplot(ds, aes(CD45, CD45RA)) +
  geom_point()
```

![](/assets/images/unnamed-chunk-1-1.png)
